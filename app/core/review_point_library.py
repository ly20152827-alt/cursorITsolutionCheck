# -*- coding: utf-8 -*-
"""
审核要点库模块
基于机场场道工程施工组织设计标准结构设计
"""


class ReviewPointLibrary:
    """审核要点库"""
    
    def __init__(self):
        self.review_points = {
            "文档完整性": self._get_document_completeness_points(),
            "编制说明": self._get_preparation_statement_points(),
            "工程概况": self._get_project_overview_points(),
            "施工部署": self._get_construction_deployment_points(),
            "施工准备": self._get_construction_preparation_points(),
            "主要施工方法": self._get_construction_methods_points(),
            "施工进度计划": self._get_schedule_points(),
            "资源配置计划": self._get_resource_allocation_points(),
            "质量保证措施": self._get_quality_assurance_points(),
            "安全保证措施": self._get_safety_assurance_points(),
            "文明施工环保": self._get_civilized_construction_points(),
            "季节性施工措施": self._get_seasonal_construction_points(),
            "应急预案": self._get_emergency_plan_points(),
            "附图附表": self._get_appendix_points()
        }
    
    def _get_document_completeness_points(self):
        """文档完整性审核要点"""
        return {
            "必含章节": [
                "1. 编制说明",
                "2. 工程概况",
                "3. 施工部署",
                "4. 施工准备",
                "5. 主要施工方法和技术措施",
                "6. 施工进度计划",
                "7. 资源配置计划",
                "8. 质量保证措施",
                "9. 安全保证措施",
                "10. 文明施工和环境保护措施",
                "11. 季节性施工措施",
                "12. 应急预案",
                "13. 附图附表"
            ],
            "审核标准": "所有必含章节必须存在，章节编号连续，无遗漏",
            "严重程度": "严重"
        }
    
    def _get_preparation_statement_points(self):
        """编制说明审核要点"""
        return {
            "编制依据": {
                "必含内容": [
                    "国家法律法规（建筑法、安全生产法等）",
                    "民航行业标准（MH/T 5014、MH 5001等）",
                    "设计文件（施工图、设计说明）",
                    "合同文件",
                    "现场勘察资料",
                    "企业技术标准"
                ],
                "审核重点": "依据是否最新版本、是否完整、是否与项目匹配",
                "严重程度": "严重"
            },
            "编制原则": {
                "必含内容": [
                    "安全第一原则",
                    "质量优先原则",
                    "科学合理原则",
                    "经济适用原则",
                    "环保节能原则"
                ],
                "审核重点": "原则是否明确、是否与项目特点相符",
                "严重程度": "一般"
            },
            "适用范围": {
                "审核重点": "是否明确说明适用的工程范围、施工阶段",
                "严重程度": "一般"
            }
        }
    
    def _get_project_overview_points(self):
        """工程概况审核要点"""
        return {
            "项目基本信息": {
                "必含内容": [
                    "项目名称、地点",
                    "建设单位、设计单位、监理单位",
                    "合同工期、质量标准",
                    "工程规模（跑道长度、宽度、面积等）",
                    "工程投资"
                ],
                "审核重点": "信息是否完整、准确、与合同一致",
                "严重程度": "严重"
            },
            "工程特点": {
                "必含内容": [
                    "地理位置特点",
                    "气候条件",
                    "地质条件",
                    "施工难点分析",
                    "技术难点分析"
                ],
                "审核重点": "特点分析是否深入、是否影响施工方案制定",
                "严重程度": "一般"
            },
            "主要工程量": {
                "必含内容": [
                    "土石方工程量",
                    "道面工程（混凝土/沥青）",
                    "排水工程",
                    "其他附属工程"
                ],
                "审核重点": "工程量是否准确、是否与设计文件一致",
                "严重程度": "严重"
            }
        }
    
    def _get_construction_deployment_points(self):
        """施工部署审核要点"""
        return {
            "施工目标": {
                "必含内容": [
                    "质量目标（合格率、优良率）",
                    "安全目标（零事故、零伤亡）",
                    "工期目标（总工期、关键节点）",
                    "文明施工目标",
                    "环保目标"
                ],
                "审核重点": "目标是否明确、可量化、可达成",
                "严重程度": "严重"
            },
            "施工组织架构": {
                "必含内容": [
                    "项目经理部组织架构图",
                    "关键岗位人员配置（项目经理、技术负责人、安全员等）",
                    "人员资质要求",
                    "职责分工"
                ],
                "审核重点": "架构是否合理、人员配置是否满足要求、资质是否达标",
                "严重程度": "严重"
            },
            "施工区段划分": {
                "必含内容": [
                    "施工区域划分方案",
                    "施工顺序安排",
                    "流水作业组织",
                    "交叉作业协调"
                ],
                "审核重点": "划分是否合理、是否有利于施工组织、是否考虑安全因素",
                "严重程度": "一般"
            },
            "施工总平面布置": {
                "必含内容": [
                    "临时设施布置（办公区、生活区、生产区）",
                    "施工道路布置",
                    "材料堆放场地",
                    "机械设备停放位置",
                    "水电布置",
                    "消防设施布置"
                ],
                "审核重点": "布置是否合理、是否符合安全距离要求、是否满足施工需要",
                "严重程度": "一般"
            }
        }
    
    def _get_construction_preparation_points(self):
        """施工准备审核要点"""
        return {
            "技术准备": {
                "必含内容": [
                    "图纸会审计划",
                    "技术交底计划",
                    "测量放线方案",
                    "试验检测计划",
                    "专项施工方案编制计划"
                ],
                "审核重点": "准备是否充分、计划是否可行、时间安排是否合理",
                "严重程度": "严重"
            },
            "现场准备": {
                "必含内容": [
                    "三通一平（水、电、路、场地平整）",
                    "临时设施建设",
                    "施工围挡设置",
                    "安全警示标志设置",
                    "测量控制点设置"
                ],
                "审核重点": "准备内容是否完整、标准是否明确",
                "严重程度": "一般"
            },
            "材料准备": {
                "必含内容": [
                    "主要材料需求计划",
                    "材料采购计划",
                    "材料检验计划",
                    "材料存储方案"
                ],
                "审核重点": "计划是否与进度匹配、检验标准是否明确",
                "严重程度": "一般"
            },
            "机械设备准备": {
                "必含内容": [
                    "主要机械设备清单",
                    "设备进场计划",
                    "设备检验计划",
                    "设备操作人员配置"
                ],
                "审核重点": "设备是否满足施工需要、计划是否合理",
                "严重程度": "一般"
            },
            "人员准备": {
                "必含内容": [
                    "人员需求计划",
                    "人员进场计划",
                    "人员培训计划",
                    "特殊工种持证情况"
                ],
                "审核重点": "人员配置是否充足、培训是否到位",
                "严重程度": "一般"
            }
        }
    
    def _get_construction_methods_points(self):
        """主要施工方法审核要点"""
        return {
            "土石方工程": {
                "必含内容": [
                    "开挖方案（开挖顺序、开挖方法）",
                    "回填方案（回填材料、压实标准）",
                    "土方平衡方案",
                    "特殊地质处理方案",
                    "质量控制措施",
                    "安全措施"
                ],
                "审核重点": "方案是否可行、是否符合规范、安全措施是否到位",
                "严重程度": "严重"
            },
            "道面工程": {
                "必含内容": [
                    "基层施工方案（级配碎石/水泥稳定碎石）",
                    "面层施工方案（混凝土/沥青）",
                    "接缝处理方案",
                    "养护方案",
                    "质量控制措施（配合比、强度、平整度等）",
                    "安全措施"
                ],
                "审核重点": "施工工艺是否符合规范、质量控制标准是否明确、关键参数是否合理",
                "严重程度": "严重"
            },
            "排水工程": {
                "必含内容": [
                    "排水系统设计说明",
                    "管道施工方案",
                    "检查井施工方案",
                    "回填方案",
                    "闭水试验方案",
                    "质量控制措施"
                ],
                "审核重点": "方案是否完整、试验标准是否明确",
                "严重程度": "一般"
            },
            "测量控制": {
                "必含内容": [
                    "测量控制网建立",
                    "施工测量方法",
                    "测量精度要求",
                    "测量仪器配置",
                    "测量复核制度"
                ],
                "审核重点": "精度是否满足要求、复核制度是否完善",
                "严重程度": "一般"
            }
        }
    
    def _get_schedule_points(self):
        """施工进度计划审核要点"""
        return {
            "进度计划编制": {
                "必含内容": [
                    "总体进度计划（横道图/网络图）",
                    "关键节点计划",
                    "里程碑节点",
                    "各分项工程进度计划"
                ],
                "审核重点": "计划是否满足合同工期、关键路径是否合理、节点是否明确",
                "严重程度": "严重"
            },
            "进度保证措施": {
                "必含内容": [
                    "组织措施",
                    "技术措施",
                    "经济措施",
                    "合同措施",
                    "进度纠偏措施"
                ],
                "审核重点": "措施是否具体、可操作、是否有效",
                "严重程度": "一般"
            },
            "进度风险分析": {
                "必含内容": [
                    "进度风险识别",
                    "风险应对措施",
                    "应急预案"
                ],
                "审核重点": "风险识别是否全面、应对措施是否有效",
                "严重程度": "一般"
            }
        }
    
    def _get_resource_allocation_points(self):
        """资源配置计划审核要点"""
        return {
            "劳动力配置": {
                "必含内容": [
                    "各阶段劳动力需求",
                    "劳动力配置计划表",
                    "特殊工种配置",
                    "劳动力保障措施"
                ],
                "审核重点": "配置是否满足进度需要、是否合理",
                "严重程度": "一般"
            },
            "材料配置": {
                "必含内容": [
                    "主要材料需求计划",
                    "材料供应计划",
                    "材料储备计划",
                    "材料质量保证措施"
                ],
                "审核重点": "计划是否与进度匹配、质量保证是否到位",
                "严重程度": "一般"
            },
            "机械设备配置": {
                "必含内容": [
                    "主要机械设备配置表",
                    "设备使用计划",
                    "设备维护保养计划",
                    "设备故障应急措施"
                ],
                "审核重点": "配置是否满足施工需要、计划是否合理",
                "严重程度": "一般"
            },
            "资金配置": {
                "必含内容": [
                    "资金需求计划",
                    "资金使用计划",
                    "资金保障措施"
                ],
                "审核重点": "计划是否合理、保障措施是否有效",
                "严重程度": "一般"
            }
        }
    
    def _get_quality_assurance_points(self):
        """质量保证措施审核要点"""
        return {
            "质量管理体系": {
                "必含内容": [
                    "质量管理组织机构",
                    "质量管理制度",
                    "质量责任制",
                    "质量检查制度"
                ],
                "审核重点": "体系是否完善、制度是否健全、责任是否明确",
                "严重程度": "严重"
            },
            "质量控制措施": {
                "必含内容": [
                    "事前控制（材料检验、技术交底）",
                    "事中控制（工序检查、旁站监督）",
                    "事后控制（验收、整改）",
                    "关键工序质量控制点",
                    "质量通病防治措施"
                ],
                "审核重点": "控制措施是否全面、关键点是否明确、是否可操作",
                "严重程度": "严重"
            },
            "质量检验计划": {
                "必含内容": [
                    "检验批划分",
                    "检验项目清单",
                    "检验标准",
                    "不合格品处理程序"
                ],
                "审核重点": "计划是否完整、标准是否明确",
                "严重程度": "一般"
            },
            "质量目标分解": {
                "审核重点": "目标是否分解到各分项工程、是否可量化",
                "严重程度": "一般"
            }
        }
    
    def _get_safety_assurance_points(self):
        """安全保证措施审核要点"""
        return {
            "安全管理体系": {
                "必含内容": [
                    "安全管理组织机构",
                    "安全管理制度",
                    "安全生产责任制",
                    "安全教育培训制度",
                    "安全检查制度"
                ],
                "审核重点": "体系是否完善、制度是否健全、是否符合法规要求",
                "严重程度": "严重"
            },
            "安全技术措施": {
                "必含内容": [
                    "施工安全技术措施",
                    "机械设备安全措施",
                    "临时用电安全措施",
                    "高空作业安全措施",
                    "深基坑安全措施",
                    "消防安全措施"
                ],
                "审核重点": "措施是否全面、是否符合规范、是否针对性强",
                "严重程度": "严重"
            },
            "重大危险源管理": {
                "必含内容": [
                    "重大危险源识别",
                    "重大危险源清单",
                    "重大危险源监控措施",
                    "重大危险源应急预案"
                ],
                "审核重点": "识别是否全面、措施是否有效、是否符合《民航专业工程施工重大安全隐患判定标准》",
                "严重程度": "严重",
                "参考标准": "民航专业工程施工重大安全隐患判定标准(试行)"
            },
            "安全防护措施": {
                "必含内容": [
                    "个人防护用品配置",
                    "安全防护设施设置",
                    "安全警示标志设置",
                    "安全通道设置"
                ],
                "审核重点": "防护是否到位、标准是否明确",
                "严重程度": "一般"
            },
            "安全检查计划": {
                "必含内容": [
                    "日常检查",
                    "专项检查",
                    "定期检查",
                    "季节性检查"
                ],
                "审核重点": "计划是否完整、频次是否合理",
                "严重程度": "一般"
            }
        }
    
    def _get_civilized_construction_points(self):
        """文明施工和环境保护措施审核要点"""
        return {
            "文明施工措施": {
                "必含内容": [
                    "现场围挡设置",
                    "场地硬化",
                    "材料堆放",
                    "垃圾处理",
                    "噪声控制",
                    "扬尘控制"
                ],
                "审核重点": "措施是否具体、标准是否明确",
                "严重程度": "一般"
            },
            "环境保护措施": {
                "必含内容": [
                    "水环境保护",
                    "大气环境保护",
                    "噪声污染防治",
                    "固体废物处理",
                    "生态保护措施"
                ],
                "审核重点": "措施是否全面、是否符合环保要求",
                "严重程度": "一般"
            },
            "节能减排措施": {
                "必含内容": [
                    "节能措施",
                    "减排措施",
                    "资源循环利用"
                ],
                "审核重点": "措施是否具体、是否可操作",
                "严重程度": "建议"
            }
        }
    
    def _get_seasonal_construction_points(self):
        """季节性施工措施审核要点"""
        return {
            "雨季施工措施": {
                "必含内容": [
                    "雨季施工准备",
                    "排水措施",
                    "材料防护措施",
                    "施工工艺调整",
                    "安全措施"
                ],
                "审核重点": "措施是否针对性强、是否可操作",
                "严重程度": "一般"
            },
            "冬季施工措施": {
                "必含内容": [
                    "冬季施工准备",
                    "防冻措施",
                    "保温措施",
                    "施工工艺调整",
                    "安全措施"
                ],
                "审核重点": "措施是否有效、是否符合规范",
                "严重程度": "一般"
            },
            "高温季节施工措施": {
                "必含内容": [
                    "防暑降温措施",
                    "材料防护措施",
                    "施工时间调整",
                    "安全措施"
                ],
                "审核重点": "措施是否合理、是否考虑人员安全",
                "严重程度": "一般"
            }
        }
    
    def _get_emergency_plan_points(self):
        """应急预案审核要点"""
        return {
            "应急组织体系": {
                "必含内容": [
                    "应急组织机构",
                    "应急人员配置",
                    "应急职责分工",
                    "应急联系方式"
                ],
                "审核重点": "组织是否健全、职责是否明确、联系方式是否有效",
                "严重程度": "严重"
            },
            "应急预案内容": {
                "必含内容": [
                    "火灾事故应急预案",
                    "坍塌事故应急预案",
                    "触电事故应急预案",
                    "机械伤害事故应急预案",
                    "环境污染事故应急预案",
                    "恶劣天气应急预案"
                ],
                "审核重点": "预案是否全面、是否可操作、是否经过演练",
                "严重程度": "严重"
            },
            "应急资源": {
                "必含内容": [
                    "应急物资清单",
                    "应急设备配置",
                    "医疗救护资源",
                    "外部救援资源"
                ],
                "审核重点": "资源是否充足、是否可及时获取",
                "严重程度": "一般"
            },
            "应急演练计划": {
                "审核重点": "计划是否明确、频次是否合理",
                "严重程度": "一般"
            }
        }
    
    def _get_appendix_points(self):
        """附图附表审核要点"""
        return {
            "必含图表": {
                "必含内容": [
                    "施工总平面布置图",
                    "施工进度计划图（横道图/网络图）",
                    "施工组织架构图",
                    "质量管理体系图",
                    "安全管理体系图",
                    "主要施工工艺流程图",
                    "主要材料需求计划表",
                    "主要机械设备配置表",
                    "劳动力配置计划表"
                ],
                "审核重点": "图表是否完整、是否清晰、是否与文字说明一致",
                "严重程度": "一般"
            },
            "图表质量": {
                "审核重点": "图表是否规范、标注是否清晰、比例是否合理",
                "严重程度": "建议"
            }
        }
    
    def get_review_points_by_chapter(self, chapter_name):
        """根据章节名称获取审核要点"""
        return self.review_points.get(chapter_name, {})
    
    def get_all_review_points(self):
        """获取所有审核要点"""
        return self.review_points
    
    def get_severity_levels(self):
        """获取严重程度分级"""
        return {
            "严重": "必须整改，否则不允许施工",
            "一般": "建议整改，影响施工质量或安全",
            "建议": "优化建议，提升方案质量"
        }
